◆発 表 日: 平成25年 2月14日(木)
◆発表会場: 工学部4号館 11番講義室
◆発表題目: Mintオペレーティングシステムにおけるデバイス移譲方式
◆発 表 者: 左海 裕庸
◆概    要:
　計算機の高性能化にともない，計算機資源を全て使用することは少なくなっ
てきた．そこで，計算機資源を有効に活用するために，複数のOSを仮想化して
1 台の計算機で動作させる技術として仮想計算機方式が研究されている．しか
し，この方式は，計算機の仮想化によるオーバヘッドのため，実計算機よりも
性能が低下する．また，OS間での処理負荷の影響が存在する．そこで，性能の
低下を抑えるため，マルチコアプロセッサ上で複数のLinuxカーネルを独立に
走行させる方式としてMintオペレーティングシステムが研究開発されている．
　OSの負荷は一定ではなく，時間とともに変化する．このため，負荷に応じて
計算機資源を動的に割り当てることで計算機資源を効率的に使用できる．一方
で，Mintでは計算機資源を各OSの起動時に静的に割り当てている．このため，
計算機資源を動的に割り当てることができない．この問題を解決するために，
Mintにおけるコアの動的割り当て機構が実現されている．また，MintはLinux
のLoadable Kernel Moduleを利用できる．このLKMのロード/アンロードを利用
して，Mintはデバイスを移譲できる．このLKMのロード/アンロードを利用した
デバイス移譲方式について，移譲時間と適用範囲について評価した．その結果，
LKMによるデバイス移譲方式は，ミリ秒単位のオーダーであることが分かった．
　また，LKMによるデバイス移譲方式より短い時間での移譲可能な方式につい
て検討した．具体的には，MSI割り込みルーティング変更によるデバイス移譲
方式について検討した．
　次に，割り込みルーティング変更によるデバイス移譲方式の課題，対処，お
よび実現について述べた．そして，割り込みルーティング変更によるデバイス
移譲方式を評価し，LKMによるデバイス移譲方式と比較した．その結果，実現
工数が大きいものの，タイムスライス間隔のような短い周期でのデバイス移譲
には，割り込みルーティング変更によるデバイス移譲方式が有用であることが
分かった．また，ユーザ任意のような比較的長い周期でのデバイス移譲には，
LKMによるデバイス移譲方式が有用であることが分かった．

◆質疑応答(敬称略)◆
Q1: MSIによるデバイス移譲時間について，各処理の測定結果と合計時間が一
    致しないのはなぜか．                                        (後藤)
A1: 計算ミスである．

Q2: デバイス移譲によって期待される効果について，具体的な例は何か．
                                                                (谷口)
A2: 例えば，Mintの利便性の向上について，1台の計算機上にNICが1つだけあ
    る場合を想定する．この場合に複数のOSを走行させたとき，一方のOSが
    NICを使用したのち，別のOSがNICを使用したい場合がある．例としては，
    それぞれのOSでネットワークを介したパッケージのインストールやアップ
    デートである．この際，デバイスの動的割り当てが不可能であれば，OSの
    再起動が必要となる．デバイス移譲による動的割り当てが可能ならば，こ
    の手間は必要ない．

Q3: Mintの利便性の向上についての具体例に関して，LKM方式ではだめなのか．
                                                                (同上)
A4: LKMによる方式が有用である．

Q4: MSIによるデバイス移譲方式が有用である事例はなにか．         (同上)
A4: 例えば，1台の計算機上に1つしかないデバイスをタイムスライス間隔のよ
    うな短い周期で移譲することにより，複数のOS間でこのデバイスを擬似的
    に共有しているように見せかけることができると考える．

C1: 擬似的に共有ではなく，共有しているものを擬似的に占有しているように
    見せかけるが正しい．                                        (同上)

Q5: MSIによるデバイス移譲方式では，デバイスドライバをあらかじめロード
    しているのか．                                              (山内)
A5: その通りである．

Q6: デバイスドライバをロードする際に対象のデバイスは共有しているのか，
    排他しているのか．                                          (同上)
A6: 現状では，一番最後にデバイスドライバをロードしたOSノードが占有して
    いる状態となる．

Q7: MSIによるデバイス移譲方式では，デバイスの切り替えに掛かる時間が10
    マイクロ秒未満であることに間違いはないのか．                (同上)
A7: 10マイクロ秒未満で間違いない．

Q8: 負荷分散での使用を考えた場合，デバイスの移譲による負荷はどの程度か．
                                                                (同上)
A7: 負荷分散を考えた際のデバイス移譲による負荷は想定していない．このた
    め，測定もしていない．予想としては，あまり影響はないと考える．

◆反省と感想◆
(1) 提出した論文と発表スライドに関して，計算を間違えた表を掲載していた．
    今後はこのような事がないよう注意して，数値について確認する．
(2) 発表中，声が小さくなる部分があった．もっと大きな声で発表するべきで
    あった．
(3) 発表時間内に発表を終えることができなかった．発表練習を十分にしてお
    くべきだった．
